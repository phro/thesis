\documentclass{article}
\usepackage{math}
\usepackage[backend=biber]{biblatex}
\addbibresource{\jobname.bib}

\title{Computing the generating function of a coinvariants map}
\author{Jesse Frohlich}

\ProvideDocumentCommand{\fa}{}{\mfk{a}}
\ProvideDocumentCommand{\Alg}{}{\fg}
\ProvideDocumentCommand{\CU}{}{U}
\ProvideDocumentCommand{\nn}{}{\mathbf{n}}
\ProvideDocumentCommand{\Order}{}{\mathbb O}
\DeclarePairedDelimiterXPP{\Gen}[1]{\msc G}\lparen\rparen{}{#1}
\DeclarePairedDelimiter{\contraction}\langle\rangle
\newcommand{\alignedintertext}[1]{%
  \noalign{%
    \vskip\belowdisplayshortskip
    \vtop{\hsize=\linewidth#1\par
    \expandafter}%
    \expandafter\prevdepth\the\prevdepth
  }%
}

\begin{document}
\maketitle

\begin{abstract}
        A rich source of quantum tangle invariants comes from universal
        enveloping algebras of quasitriangular Lie algebras. While such
        algebras are traditionally used to construct tangle invariants, it is
        also of interest to extend the invariants to links. Doing so amounts
        topologically to closing open strands, and algebraically to a defining a
        trace map on the algebra. We define a candidate trace map for the
        Drinfeld double of the nonabelian 2-dimensional Lie algebra by both
        constructing the space of coinvariants and describing the generating
        function of the corresponding map in a closed form.
\end{abstract}

\section{Introduction}

In \cite{BV}, Bar-Natan and Van der Veen define an invariant of tangles valued
in tensor powers of a certain Hopf algebra $\CU$. Their work expresses the
algebra operations as perturbed Gaußian generating functions so as to produce a
strong polynomial-time tangle invariant.

We begin by defining the algebra $\CU$. Denote by $\fa$ the non-commutative
$2$-dimensional cocommutative Lie bialgebra spanned by $a$ and $x$ with relation
$\liebk{a}{x} = x$. (This is also a Borel subalgebra of $\Sl_2$.)

Next, we use the Drinfeld double construction (outlined in \cite{ES}) to obtain
a quasitriangular Lie algebra $\fg$. As a vector space,
$\fg = \fa \oplus \dual\fa$. Given $u \in \fa$ and $v\in \dual \fa$, we have
$\liebk{u}{v}_{\fg} \defeq \dual\ad_u(v) - \dual\ad_v(u)$, extended bilinearly
and anticommutatively to all of $\fg$.
Then the algebra $\CU$ is defined to be the universal enveloping algebra
$\uea{\fg}$.

\begin{remark}
        For convenience, we define $b \defeq \dual a \in \dual\fa$ and
        $y \defeq \dual x \in \dual\fa$, so that
        \begin{equation}
                U = \genbuilder*{y, b, a, x}{
                        \liebk{a}{x} = x,
                        \liebk{a}{y} = -y,
                        \liebk{x}{y} = b,
                        \liebk{b}{ } = 0
                }
        \end{equation}
        as an algebra.
\end{remark}

\subsection{Expressing morphisms as generating functions}

When defining a morphism-valued tangle invariant, one needs a compact way of
encoding the morphism. In \cite{BV} this is achieved through the use of
generating functions, whose definition we reproduce below:

For $A$ and $B$ finite sets, consider the set $\hom(\polyring{\Q}{z_A},
\polyring{\Q}{z_B})$ of linear maps between multivariate polynomial rings. Such
a map is determined by its values on the monomials $z_A^\nn$ for each
multi-index $\nn \in \N^A$.

\begin{definition}[Exponential generating function]
        The \defi{exponential generating function} of a map
        $\map {Φ} {\polyring{\Q}{z_A}} {\polyring{\Q}{z_B}}$ between polynomial
        spaces is
        \begin{equation}
                \Gen{Φ} \defeq
                \Sum[\nn\in\N^A] \frac{Φ(z_A^\nn)}{\nn!}ζ_A^\nn
                \in \powerseries{\polyring{\Q}{z_B}}{ζ_A}
        \end{equation}
\end{definition}
\begin{remark}
        Extending the definition of $Φ$ to
        $\powerseries{\polyring{\Q}{z_B}}{ζ_A}$ by the extending scalars to
        $\powerseries{\Q}{ζ_A}$ gives us an equivalent formulation:
        \begin{equation}
                \Gen{Φ}
                = Φ\pn*{\Sum[\nn\in\N^A] \frac{(z_Aζ_A)^\nn}{\nn!}}
                = Φ\pn*{\Gen[\big]{\id_{\polyring{\Q}{z_A}}}}
        \end{equation}
\end{remark}

By the PBW theorem, we know that $\CU$ is isomorphic as a vector space to the
polynomial ring $\polyring{\Q}{y, b, a, x}$ by choosing an ordering of the
generators (following \cite{BV}, we use $(y, b, a, x)$):
\begin{equation}
        \mapdef {\Order} {\polyring{\Q}{y, b, a, x}} [\toiso] {\CU}
        {y^{n_1}b^{n_2}a^{n_3}x^{n_4}} {y^{n_1}b^{n_2}a^{n_3}x^{n_4}}
\end{equation}

Using this vector space isomorphism, \cite{BV} expresses all Hopf algebra
operations as perturbed Gaußians. To extend the resulting tangle invariant to
one on links, one would need to define a trace operator on $\CU$. The first
natural place to look is the coinvariants,
$\CU_\CU = \fracl{\CU}{\liebk{\CU}{\CU}}$. In what follows, we will compute
$\CU_\CU$, determine a vector space isomorphism to a suitable polynomial ring,
and compute the corresponding generating function of the quotient map $\map
{\trace} {\CU} {\CU_\CU}$.

\section{The coinvariants of $U$}

We start with a result which simplifies working with coinvariants:

\begin{lemma}\label{lem:coinvLieAlg}
        Let $\fh$ be a Lie algebra. Then $\uea{\fh}_{\uea{\fh}} =
        \uea{\fh}_\fh$.
\end{lemma}
\begin{proof}
First, observe that for any $u$, $v$, $f\in\uea{\fh}$,
$\ad_{uv}(f) = \ad_u(vf) + \ad_v(fu)$. Proceeding inductively, for any monomial
$μ\in\uea{\fh}$, $\ad_{μ}(u)$ is a linear combination of elements of
$\liebk*{\fh}{\uea{\fh}}$. By linearity of $\ad$, we conclude
$\liebk*{\uea{\fh}}{\uea{\fh}} = \liebk*{\fh}{\uea{\fh}}$.
\end{proof}

\begin{theorem}
        The coinvariants of $U$, $U_U$, has basis
        $\set{y^n a^k x^n}_{n, k\ge 0}$.
\end{theorem}
\begin{proof}
Using \cref{lem:coinvLieAlg}, we need only compute $\liebk{\Alg}{\CU}$ to
determine $\CU_\CU$. Given a polynomial $f$, we have the
following relations in $U$:
\begin{align}
        f(a)y^r &= y^rf(a-r) &
        x^rf(a) &= f(a-r)x^r
\end{align}
Next we compute the adjoint actions of $y$, $a$, and $x$. (Recall $b$ is
central.)
\begin{align}
  \ad_a f(x) &= xf'(x)&
  \ad_a f(y) &= -yf'(y)\label{eq:ada}\\
  \ad_x f(y) &= bf'(y) &
  \ad_x f(a) &= -\nabla[f](a)x\label{eq:adx}\\
  \ad_y f(x) &= -bf'(x) &
  \ad_y f(a) &= y\nabla[f](a)\label{eq:ady}
\end{align}
(Here $\nabla$ is the backwards finite difference operator $\nabla[f](x) \defeq
f(x) - f(x-1)$.) Observe for any $n$, $m$, $k$, and polynomials $f$ and $g$:
\begin{align}
        \ad_a \pn*{y^m g(b, a) x^n } &= (n-m)y^mg(b, a) x^n
        \label{eq:ada_rel}\\
        \ad_{x}\pn*{y^{n+1}b^{m-1}f(a)x^{k}} &=
                (n+1)y^{n}b^{m}f(a)x^{k} - y^{n+1}b^{m-1}\nabla[f](a)x^{k+1}
        \label{eq:adx_rel}\\
        \ad_{y}\pn*{y^n b^{m-1} f(a) x^{k+1}} &=
                - (k+1)y^n b^m f(a) x^k + y^{n+1} b^{m-1} \nabla[f](a)x^{k+1}
        \label{eq:ady_rel}
\end{align}
By \cref{eq:ada_rel}, any monomial whose powers of $y$ and $x$ differ vanish in
$\CU_{\Alg}$. As a consequence, in \cref{eq:adx_rel,eq:ady_rel}, the only
nontrivial case is when $n=k$, resulting in the same relation. By induction on
$n$, we conclude that:
\begin{equation}\label{eq:coinv_reduction}
        y^n b^m f(a) x^k \sim δ_{nk}\frac{n!}{(n+m)!}y^{n+m}\nabla^m[f](a)x^{n+m}
\end{equation}
Observing when $f$ is a monomial in \cref{eq:coinv_reduction}, we see
$\CU_{\Alg}$ is spanned by $\set{y^n a^k x^n}_{n, k \ge 0}$. Since all relations are
accounted for, setting $m=0$  demonstrates this set is linearly independent, and
we have a basis.
\end{proof}

\subsection{A generating function for the coinvariants}

\ProvideDocumentCommand{\COrder}{}{\Order}
In order to define a generating function, we need to choose an appropriate basis
for the space of coinvariants. We define an isomorphism from the space of
coinvariants to a polynomial space, tweaking the earlier-defined basis by scalar
multiples. Since it plays the role of the ordering map, we also name it
$\COrder$.
\begin{equation}
        \mapdef {\COrder} {\polyring{\Q}{a, z}} [\toiso] {\CU_\CU}
        {a^{n}z^{k}} {\frac{1}{k!}y^{k}a^{n}x^{k} \\
                k!\nabla^m[f](a)z^{k+m} &\mapsfrom y^kb^mf(a)x^k
        }
\end{equation}

This defines a commutative square upon whose bottom edge
$τ = \Order \then {\trace} \then {\inv{\COrder}}$ we compute the generating
function:
\begin{equation}
\begin{tikzcd}
        \CU
                \rar["\trace"]
        & \CU_\CU \\
        \polyring{\Q}{y, b, a, x}
                \uar["\Order"]
                \rar["τ"]
        &
        \polyring{\Q}{a, z}
                \uar["\COrder"]
\end{tikzcd}
\end{equation}

We begin with a result on finite differences:
\begin{lemma}\label{eq:findiffexp}
        The finite difference operator acts in the following way on
        exponentials:
        \begin{equation}
                \nabla^n[\Exp{αa}](a) = (1-\Exp{-α})^n\Exp{αa}
        \end{equation}
\end{lemma}
\begin{proof}
Using the fact that $\nabla^n[f](x) = \Sum[k=0][n]\binom n k(-1)^kf(x-k)$, we
see that
$\nabla^n[\Exp{αa}](a)
        = \Sum[k=0][n]\binom n k(-1)^k\Exp{αa-αk}
        % = \Exp{αa}\Sum[k=0][n]\binom n k(-1)^k\Exp{-αk}
        = (1-\Exp{-α})^n\Exp{αa}$.
\end{proof}
We now are ready to compute the generating function for the trace:
\begin{theorem}[Generating function for the trace of $\CU$]
\begin{equation}\label{eq:trace_formula}
        \Gen\trace = \Exp{αa+\pn*{ηξ+β(1-\Exp{-α})}z}
\end{equation}
\end{theorem}
\begin{proof}
        Using \cref{eq:findiffexp} and the extension of scalars of $\trace$ to
        $\powerseries{\Q}{η, β, α, ξ}$, we see
        \begin{equation}
        \begin{aligned}
                &\Gen[\big]{\Order \then {\trace} \then {\inv{\COrder}}}
                = \pn[\big]{\Exp{η y} \Exp{β b} \Exp{α a} \Exp{ξ x}} \then
                        {\trace} \then {\inv\COrder}\\
                &= \inv\COrder\Sum[i, j, k]\trace\pn*{
                        \frac{(η y)^i}{i!}
                        \frac{(β b)^j}{j!}
                        \Exp{α a}
                        \frac{(ξ x)^k}{k!}
                }\\
                % &=\Sum[i, j, k]\frac{η^i β^j ξ^k}{i! j! k!}
                        % \trace\pn*{ y^i b^j \Exp{α a} x^k }\\
                % &=\Sum[i, j, k]\frac{η^i β^j ξ^k}{i! j! k!}
                        % δ_{ik}i!\nabla^j[\Exp{αa}](a)t^{i+j}\\
                &=\Sum[i, j]\frac{η^i β^j ξ^i}{i! j!}
                        (1-\Exp{-α})^j\Exp{αa}z^{i+j}
                =\Exp{αa+\pn*{ηξ+β(1-\Exp{-α})}z}\qedhere
        \end{aligned}
        \end{equation}
\end{proof}

\section{Sample computations}
Here we will outline a computation involving the trace by using Bar-Natan and
van der Veen's Contraction Theorem.

A typical value for a tangle invariant that arises is of the form:
\begin{equation}\label{eq:sample_GDO}
        P\Exp{c + α a_i + β b_i + ξ(b_i) x_i + η(b_i)y_i + λ(b_i)x_i y_i}
\end{equation}
Here, $c$, $α$, and $β$ denotes a constant with respect to the variables $y_i$,
$b_i$, $a_i$, and $x_i$ (collectively referred to as \enquote{$v_i$}s), while
$ξ$, $η$, and $λ$ are potentially $b_i$-dependent, and $P$ is a (rational)
function in (the square root of) $B_i$.

Let us compute the trace of \cref{eq:sample_GDO}. For clarity, we will put bars
over the coinvariants variables $a_i$ and $z_i$, as they do not play a role in
the contraction.
\ProvideDocumentCommand{\ba}{}{\bar{a}}
\ProvideDocumentCommand{\bz}{}{\bar{z}}
\begin{equation}\begin{aligned}
        &\contraction{
                P(B_i)
                \Exp{c + α a_i + β b_i + ξ(b_i) x_i + η(b_i)y_i + λ(b_i)x_i y_i}
                \trace^i
        }_{v_i}\\
        &= \contraction{
                P(B_i)
                \Exp{c + β b_i + ξ(b_i) x_i + η(b_i)y_i + λ(b_i)x_i y_i
                +η_iξ_i\bz_i+β_i(1-\Exp{-α_i})\bz_i}
                \Exp{α a_i + α_i\ba_i}
        }_{v_i}\\
        &= \Exp{α\ba_i}\contraction{
                P(B_i)
                \Exp{c + ξ(b_i) x_i + η(b_i)y_i + λ(b_i)x_i y_i
                +η_iξ_i\bz_i}
                \Exp{β b_i +β_i(1-\Exp{-α})\bz_i}
        }_{b_i, x_i, y_i}\\
        \alignedintertext{In what follows, we let $μ\defeq (1-\Exp{-α})\bz_i$:}
        &= \Exp{c+α\ba_i+βμ}P(\Exp{-μ})\contraction{
                \Exp{η(μ)y_i}
                \Exp{(ξ(μ) + λ(μ)y_i)x_i + ξ_iη_i\bz_i}
        }_{x_i, y_i}\\
        &= \Exp{c+α\ba_i+βμ}P(\Exp{-μ})\contraction{
                \Exp{η(μ)y_i+ξ(μ)\bz_iη_i + λ(μ)\bz_iη_iy_i}
        }_{y_i}\\
        &= \frac{P(\Exp{-μ})\Exp{c+α\ba_i+βμ+\frac{η(μ)ξ(μ)\bz_i}{1-λ(μ)\bz_i}}}
                {1-λ(μ)\bz_i}
\end{aligned}\end{equation}

\section{Comparison with the Multivariable Alexander polynomial}

On all two-component links with at most $11$ crossings (a collection of size
$914$), the trace map attains $878$ distinct values, while the MVA attains only
$778$. However, the two invariants are incomparable in terms of their strength.

\section{Further work}
While all other Hopf algebra operations in $U$ are expressed by \cite{BV} as
perturbed Gaußians, the form in \cref{eq:trace_formula} does not to conform to
the same structure. Further work is needed to either implement this operation
into the established framework, or to suitably extend the framework.

\printbibliography
\end{document}
